<rhn-interface name="user">

  <rhn-method name="use_pam_authentication">
    <description>flags whether or not to use PAM authentication for
    verifying a user's password</description>
    <handler class="Sniglets::API::User" />

    <param name="session" type="session" mangle="session_user" />
    <param name="login" type="string" mangle="objectify_login" />
    <param name="value" type="boolean" />

    <return type="boolean" />
  </rhn-method>


  <rhn-method name="create">
    <description>Creates a new user account</description>
    <handler class="Sniglets::API::User" />

    <param name="session" type="session" mangle="session_user" />
    <param name="desired_login" type="string" />
    <param name="desired_password" type="string" />
    <param name="first_name" type="string" />
    <param name="last_name" type="string" />
    <param name="email" type="string" />
    <param name="use_pam_authentication" type="string" />

    <return type="boolean" />
  </rhn-method>


  <rhn-method name="get_details">
    <description>Obtails a details hash about a given login</description>
    <handler class="Sniglets::API::User" />

    <param name="session" type="session" mangle="session_user" />
    <param name="login" type="string" />

    <return type="hash">
      <key name="first_names" type="string" />
      <key name="last_name" type="string" />
      <key name="email" type="string" />
      <key name="created_date" type="string" />
      <key name="last_login_date" type="string" />
    </return>
  </rhn-method>


  <rhn-method name="set_details">
    <description>Sets info fields for a user such as name and email
    given a username</description>
    <handler class="Sniglets::API::User" />

    <param name="session" type="session" mangle="session_user" />
    <param name="login" type="string" />
    <param name="details" type="hash">
      <key name="first_names" type="string" />
      <key name="last_name" type="string" />
      <key name="email" type="string" />
    </param>

    <return type="boolean" />
  </rhn-method>


  <rhn-method name="list_roles">
    <description>Returns a list of the roles for the given login</description>
    <handler class="Sniglets::API::User" />

    <param name="session" type="session" mangle="session_user" />
    <param name="login" type="string" />

    <return type="list">
      <string />
    </return>
  </rhn-method>


  <rhn-method name="add_role">
    <description>Adds a role to a user</description>
    <handler class="Sniglets::API::User" />

    <param name="session" type="session" mangle="session_user" />
    <param name="login" type="string" mangle="objectify_login" />
    <param name="role_label" type="string" />

    <return type="boolean" />
  </rhn-method>


  <rhn-method name="remove_role">
    <description>Removes a role from a user</description>
    <handler class="Sniglets::API::User" />

    <param name="session" type="session" mangle="session_user" />
    <param name="login" type="string" mangle="objectify_login" />
    <param name="role_label" type="string" />

    <return type="boolean" />
  </rhn-method>


  <rhn-method name="list_users">
    <description>Returns a list of the users in your org</description>
    <handler class="Sniglets::API::User" />

    <param name="session" type="session" mangle="session_user" />

    <return type="list">
      <hash>
        <key name="id" type="id" />
        <key name="login" type="string" />
        <key name="first_names" type="string" />
        <key name="last_name" type="string" />
        <key name="email" type="string" />
      </hash>
    </return>
  </rhn-method>


  <rhn-method name="delete">
    <description>Deletes the user with the given login</description>
    <handler class="Sniglets::API::User" />

    <param name="session" type="session" mangle="session_user" />
    <param name="login" type="string" />

    <return type="boolean" />
  </rhn-method>
</rhn-interface>
