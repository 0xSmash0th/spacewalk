	
	select rhnserver.id as server_id, rhnserver.name as profile_name,
		rhnservernetwork.hostname, trim(rhnservernetwork.ipaddr) as ip_address,
		( select login from web_contact where rhnserver.creator_id = web_contact.id ) as registered_by,
		to_char(rhnserver.created, 'YYYY-MM-DD HH24:MI:SS') as registration_time,
		( select to_char(checkin, 'YYYY-MM-DD HH24:MI:SS') from rhnserverinfo where rhnserver.id = server_id ) as last_checkin_time,
		running_kernel as kernel_version,
		( select count(distinct rhnpackage.name_id) from rhnpackage, rhnserverneededpackagecache
			where rhnserver.id = rhnserverneededpackagecache.server_id
				and rhnserverneededpackagecache.package_id = rhnpackage.id ) as packages_out_of_date,
		( select count(*) from rhnServerErrataTypeView where rhnserver.id = server_id ) as errata_out_of_date
	from rhnserver,
		(
		select server_id, hostname, ipaddr
		from rhnservernetwork
		where id in (
			select min(id)
			from rhnservernetwork
			group by server_id
			)
		) rhnservernetwork
	where rhnserver.id = rhnservernetwork.server_id (+)
	order by server_id

