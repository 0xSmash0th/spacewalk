
columns:

	server_id
	profile_name
	hostname
	ip_address
	registered_by
	registration_time
	last_checkin_time
	kernel_version
	packages_out_of_date
	errata_out_of_date
	software_channel
	configuration_channel
	entitlements
	system_group
	organization
	virtual_host
	architecture

multival_columns:

	server_id
	software_channel : software_channel
	configuration_channel : configuration_channel
	entitlements : entitlements
	system_group : system_group
	virtual_host : virtual_host

sql:

	select rhnserver.id as server_id, rhnserver.name as profile_name,
		rhnservernetwork.hostname, trim(rhnservernetwork.ipaddr) as ip_address,
		( select login from web_contact where rhnserver.creator_id = web_contact.id ) as registered_by,
		to_char(rhnserver.created, 'YYYY-MM-DD HH24:MI:SS') as registration_time,
		( select to_char(checkin, 'YYYY-MM-DD HH24:MI:SS') from rhnserverinfo where rhnserver.id = server_id ) as last_checkin_time,
		running_kernel as kernel_version,
		( select count(distinct rhnpackage.name_id) from rhnpackage, rhnserverneededpackagecache
			where rhnserver.id = rhnserverneededpackagecache.server_id
				and rhnserverneededpackagecache.package_id = rhnpackage.id ) as packages_out_of_date,
		( select count(*) from rhnServerErrataTypeView where rhnserver.id = server_id ) as errata_out_of_date,
		rhnchannel.name as software_channel,
		rhnconfigchannel.name as configuration_channel,
		entitlement_data.name as entitlements,
		group_data.name as system_group,
		(
		select name from web_customer where rhnserver.org_id = web_customer.id
		) as organization,
		virtual_data.host_system_id as virtual_host,
		(
		select rhnserverarch.name from rhnserverarch where rhnserver.server_arch_id = rhnserverarch.id
		) as architecture
	from rhnserver,
		(
		select server_id, hostname, ipaddr
		from rhnservernetwork
		where id in (
			select min(id)
			from rhnservernetwork
			group by server_id
			)
		) rhnservernetwork,
		rhnserverchannel, rhnchannel,
		rhnserverconfigchannel, rhnconfigchannel,
		(
		select rhnservergroupmembers.server_id, rhnservergroupmembers.server_group_id, rhnservergroup.name
		from rhnservergroupmembers, rhnservergroup
		where rhnservergroupmembers.server_group_id = rhnservergroup.id (+)
			and rhnservergroup.group_type is not null
		) entitlement_data,
		(
		select rhnservergroupmembers.server_id, rhnservergroupmembers.server_group_id, rhnservergroup.name
		from rhnservergroupmembers, rhnservergroup
		where rhnservergroupmembers.server_group_id = rhnservergroup.id (+)
			and rhnservergroup.group_type is null
		) group_data,
		(
		select host_system_id, virtual_system_id
		from rhnvirtualinstance
		where host_system_id is not null
		) virtual_data
	where rhnserver.id = rhnservernetwork.server_id (+)
		and rhnserver.id = rhnserverchannel.server_id (+)
		and rhnserverchannel.channel_id = rhnchannel.id (+)
		and rhnserver.id = rhnserverconfigchannel.server_id (+)
		and rhnserverconfigchannel.config_channel_id = rhnconfigchannel.id (+)
		and rhnserver.id = entitlement_data.server_id (+)
		and rhnserver.id = group_data.server_id (+)
		and rhnserver.id = virtual_data.virtual_system_id (+)
	order by server_id, rhnchannel.parent_channel nulls first, rhnchannel.id,
		rhnconfigchannel.id, entitlement_data.server_group_id, group_data.server_group_id,
		virtual_data.host_system_id

