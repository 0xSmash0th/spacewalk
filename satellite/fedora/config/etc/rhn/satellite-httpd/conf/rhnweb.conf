<IfModule !perl_module>
LoadModule perl_module modules/mod_perl.so
</IfModule>

PerlTaintCheck Off

PerlFixupHandler Apache2::SizeLimit

PerlRequire /etc/rhn/satellite-httpd/conf/startup.pl

# these will be set via /etc/sysconfig/satellite-httpd
PerlPassEnv ORACLE_HOME
PerlPassEnv NLS_LANG

PerlOptions +GlobalRequest

ErrorDocument 403 /errors/permission.pxt
ErrorDocument 404 /errors/404.pxt
ErrorDocument 413 /errors/413.pxt
ErrorDocument 500 /errors/500.pxt

AddType text/pxt .pxt
<Files *.pxt>
  SetHandler perl-script
  PerlHandler PXT::ApacheHandler
</Files>

<Files *.pxi>
    Order allow,deny
    Deny from all
    Satisfy All
</Files>

LoadModule jk_module modules/mod_jk.so

# <IfDefine HAVE_JK>
  JkWorkersFile /etc/rhn/satellite-httpd/conf/workers.properties
  JkLogLevel info
  JkLogFile /var/log/httpd/mod_jk.log
  JkMount /rhn/* ajp13
  JkMount /rhn ajp13
  JkMount /*.do ajp13
  JkMount /*.jsp ajp13
  JkHTTPSIndicator HTTPS
# </IfDefine>

RedirectMatch ^/renew/.* http://rhn.redhat.com
RedirectMatch ^/index\.html$ /rhn/Login.do

# Turn rewrite engine on so we can use it for 
# kickstart requests.
RewriteEngine on

# Disable TRACE and TRACK
RewriteCond %{REQUEST_METHOD} ^(TRACE|TRACK)
RewriteRule .* - [F]

# This rule handles incoming kickstart file requests from
# machines actually performing a kickstart. This rule
# processes the incoming URL and converts it into something
# slightly more Struts friendly.
RewriteRule ^/kickstart/ks([-a-zA-Z0-9\._/\%\ ]*)$ /rhn/kickstart/DownloadFile.do?ksurl=$1 [P]
RewriteRule ^/rpc/api /rhn/rpc/api [P]

# For rhn-custom-info
RewriteRule ^/WEBRPC /rhn/rpc/api [P]
